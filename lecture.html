<html>
  <head>
    <script src="https://unpkg.com/react@16/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/axios/0.19.0/axios.js'></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/react-router-dom/5.0.1/react-router-dom.js'></script>
  </head>
  <body>
  <div id='root'></div>
    <script type='text/babel'>
      const { render } = ReactDOM;
      const { Component, createElement } = React;
      const { HashRouter, Route, NavLink, Switch, Redirect} = ReactRouterDom

      class Create extends Component {
        constructor() {
          super();
          this.state = {
            item: ''
          };
          this.create = this.create.bind(this);
        }
        create() {
          this.props.onCreate(this.state.item)
          this.props.history.push('/orders/preparing')
        }
        render() {
          const { item } = this.state;
          const { create } = this;
          return (
            <form onSubmit= { ev => ev.preventDefault() }>
              <input name='item' value={ item } onChange = { ev => this.setState({ item: ev.target.value }) }/>
              <button disabled={ !item } onClick={ create }>Create Order</button>
            </form>
          );
        }
      }

      const Orders = ({ match, orders }) => {
        const status = match.params.status;
        const filtered = orders.filter( order => order.status === status);
        return (
          <div>
            <h2> { match.params.status } </h2>
              <ul>
                {
                  filtered.map( order => <li key={ order.id }> {order.item} </li>)
                }
              </ul>
          </div>
        );
      }

      const Nav = ({ orders }) => {
        const delivered = orders.filter( order => order.status === 'delivered')
        return (
          <nav>
            <Navlink to='/orders/delivered'>Delivered ({ delivered.length })</NavLink>
            <Navlink to='/orders/preparing'>Preparing</NavLink>
            <Navlink to='/orders/create'>Create Order</NavLink>
          </nav>
        );
      }

      class App extends Component {
        constructor() {
          super();
          this.state = {
            orders: []
          };
          this.onCreate = this.onCreate.bind(this)
        }
        onCreate(item) {
          //axios call & post req, dont do below
          const orders = [...this.state.orders, { id: Math.random(), status: 'preparing'}]
          this.setState({ orders })
        }
        componentDidMount() {
          //api async axios
        }
        render() {
          const { orders } = this.state;
          const ( onCreate ) = this;
          return (
            <HashRouter>
              <Route render={ () => <Nav orders={ orders } /> } />
              <Switch>
                <Route path='/orders/create' render = { (props) => <Create onCreate={onCreate} /> } />
                <Route path='/orders/:status' render = { (props) => <Orders match = { props.match } orders = { orders } /> } />
                <Redirect to='orders/preparing' />
              </Switch>
            </HashRouter>
          );
        }
      }

      const root = document.querySelector('#root');
      render( <App />, root )
    </script>
  </body>
</html>
